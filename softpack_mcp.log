2025-06-26 13:14:09 | INFO     | __main__:<module>:5 | Loguru setup test successful
2025-06-26 13:16:42 | INFO     | softpack_mcp.main:lifespan:22 | Starting Softpack MCP server
2025-06-26 13:17:57 | INFO     | softpack_mcp.main:lifespan:26 | Shutting down Softpack MCP server
2025-06-26 13:29:58 | INFO     | softpack_mcp.main:lifespan:22 | Starting Softpack MCP server
2025-06-26 13:54:13 | INFO     | softpack_mcp.services.spack_service:__init__:26 | Initialized SpackService
2025-06-26 13:54:13 | INFO     | softpack_mcp.services.spack_service:search_packages:111 | Searching packages
2025-06-26 13:54:13 | DEBUG    | softpack_mcp.services.spack_service:_run_command:45 | Running command
2025-06-26 13:54:13 | ERROR    | softpack_mcp.services.spack_service:_run_command:88 | Command execution failed
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7fa47eec6180>
    │       └ <function run at 0x7fa4792363e0>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7fa479236660>
    └ <uvicorn.server.Server object at 0x7fa47925f9b0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fa479236700>
           │       │   └ <uvicorn.server.Server object at 0x7fa47925f9b0>
           │       └ <function run at 0x7fa47cdfd580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7fa4792a4d60>
           │      └ <function Runner.run at 0x7fa47c650cc0>
           └ <asyncio.runners.Runner object at 0x7fa479659520>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7fa479283c60>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7fa479659520>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa4795aa690>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478cc1f...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7fa47eec6180>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa4795aa690>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478cc1f...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478cc1f...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa478c917c0>
          └ <fastapi.applications.FastAPI object at 0x7fa47eec6180>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa478c9bce0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa478c916a0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa478c917c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa478c9bce0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa478c91730>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa478c916a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa478c9bce0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7fa478cc2210>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fa47a05cda0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa478c91730>
          └ <function wrap_app_handling_exceptions at 0x7fa479eda2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa478cb14e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7fa47a05cda0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa478cb14e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fa47a05cda0>>
          └ <fastapi.routing.APIRouter object at 0x7fa47a05cda0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa478cb14e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7fa479edb7e0>
          └ APIRoute(path='/api/v1/spack/packages', name='list_packages', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa478cb14e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7fa4796c6700>
          └ APIRoute(path='/api/v1/spack/packages', name='list_packages', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa478cb14e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7fa478cc3980>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fa478cb1800>
          └ <function wrap_app_handling_exceptions at 0x7fa479eda2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa478cb18a0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fa478cb1800>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7fa478cc3980>
                     └ <function get_request_handler.<locals>.app at 0x7fa4796c58a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fa479ed9bc0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'spack': <softpack_mcp.services.spack_service.SpackService object at 0x7fa478cc3a70>, 'query': '', 'limit': 10}
                 │         └ <function list_packages at 0x7fa47969b7e0>
                 └ Dependant(path_params=[], query_params=[ModelField(field_info=Query(), name='query', mode='validation'), ModelField(field_inf...

  File "/home/ubuntu/work/softpack-mcp/softpack_mcp/tools/spack.py", line 44, in list_packages
    packages = await spack.search_packages(query=query, limit=limit)
                     │     │                     │            └ 10
                     │     │                     └ ''
                     │     └ <function SpackService.search_packages at 0x7fa4796c4e00>
                     └ <softpack_mcp.services.spack_service.SpackService object at 0x7fa478cc3a70>

  File "/home/ubuntu/work/softpack-mcp/softpack_mcp/services/spack_service.py", line 117, in search_packages
    result = await self._run_command(cmd)
                   │    │            └ ['/opt/spack/bin/spack', 'list']
                   │    └ <function SpackService._run_command at 0x7fa4796c4900>
                   └ <softpack_mcp.services.spack_service.SpackService object at 0x7fa478cc3a70>

> File "/home/ubuntu/work/softpack-mcp/softpack_mcp/services/spack_service.py", line 48, in _run_command
    process = await asyncio.create_subprocess_exec(
                    │       └ <function create_subprocess_exec at 0x7fa47c669260>
                    └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>

  File "/usr/local/lib/python3.12/asyncio/subprocess.py", line 224, in create_subprocess_exec
    transport, protocol = await loop.subprocess_exec(
                                │    └ <cyfunction Loop.subprocess_exec at 0x7fa4792f1560>
                                └ <uvloop.Loop running=True closed=False debug=False>
  File "uvloop/loop.pyx", line 2841, in subprocess_exec
    return await self.__subprocess_run(protocol_factory, args, shell=False,
  File "uvloop/loop.pyx", line 2799, in __subprocess_run
    proc = UVProcessTransport.new(self, protocol,
           └ <class 'uvloop.loop.UVProcessTransport'>
  File "uvloop/handles/process.pyx", line 611, in uvloop.loop.UVProcessTransport.new
    handle._init(loop, args, env, cwd, start_new_session,
  File "uvloop/handles/process.pyx", line 112, in uvloop.loop.UVProcess._init
    raise convert_error(err)

FileNotFoundError: [Errno 2] No such file or directory
2025-06-26 13:54:13 | ERROR    | softpack_mcp.services.spack_service:search_packages:120 | Package search failed
2025-06-26 13:54:13 | ERROR    | softpack_mcp.tools.spack:list_packages:47 | Failed to list packages
2025-06-26 13:54:13 | WARNING  | softpack_mcp.utils.exceptions:http_exception_handler:69 | HTTP exception
2025-06-26 13:56:16 | INFO     | softpack_mcp.services.spack_service:search_packages:111 | Searching packages
2025-06-26 13:56:16 | DEBUG    | softpack_mcp.services.spack_service:_run_command:45 | Running command
2025-06-26 13:56:16 | ERROR    | softpack_mcp.services.spack_service:_run_command:88 | Command execution failed
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7fa47eec6180>
    │       └ <function run at 0x7fa4792363e0>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7fa479236660>
    └ <uvicorn.server.Server object at 0x7fa47925f9b0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fa479236700>
           │       │   └ <uvicorn.server.Server object at 0x7fa47925f9b0>
           │       └ <function run at 0x7fa47cdfd580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7fa4792a4d60>
           │      └ <function Runner.run at 0x7fa47c650cc0>
           └ <asyncio.runners.Runner object at 0x7fa479659520>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7fa479283c60>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7fa479659520>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa4795aa690>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478cf67...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7fa47eec6180>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa4795aa690>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478cf67...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478cf67...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa478c917c0>
          └ <fastapi.applications.FastAPI object at 0x7fa47eec6180>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa4766f4860>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa478c916a0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa478c917c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa4766f4860>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa478c91730>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fa478c916a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa4766f4860>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7fa478cf6d20>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fa47a05cda0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa478c91730>
          └ <function wrap_app_handling_exceptions at 0x7fa479eda2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa4766f4720>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7fa47a05cda0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa4766f4720>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fa47a05cda0>>
          └ <fastapi.routing.APIRouter object at 0x7fa47a05cda0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa4766f4720>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7fa479edb7e0>
          └ APIRoute(path='/api/v1/spack/packages', name='list_packages', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa4766f4720>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7fa4796c6700>
          └ APIRoute(path='/api/v1/spack/packages', name='list_packages', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa4766f4720>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7fa478cf6a80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fa4766f47c0>
          └ <function wrap_app_handling_exceptions at 0x7fa479eda2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa4766f4a40>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa478c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fa4766f47c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7fa478cf6a80>
                     └ <function get_request_handler.<locals>.app at 0x7fa4796c58a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7fa479ed9bc0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'spack': <softpack_mcp.services.spack_service.SpackService object at 0x7fa478cc3a70>, 'query': '', 'limit': 10}
                 │         └ <function list_packages at 0x7fa47969b7e0>
                 └ Dependant(path_params=[], query_params=[ModelField(field_info=Query(), name='query', mode='validation'), ModelField(field_inf...

  File "/home/ubuntu/work/softpack-mcp/softpack_mcp/tools/spack.py", line 44, in list_packages
    packages = await spack.search_packages(query=query, limit=limit)
                     │     │                     │            └ 10
                     │     │                     └ ''
                     │     └ <function SpackService.search_packages at 0x7fa4796c4e00>
                     └ <softpack_mcp.services.spack_service.SpackService object at 0x7fa478cc3a70>

  File "/home/ubuntu/work/softpack-mcp/softpack_mcp/services/spack_service.py", line 117, in search_packages
    result = await self._run_command(cmd)
                   │    │            └ ['/opt/spack/bin/spack', 'list']
                   │    └ <function SpackService._run_command at 0x7fa4796c4900>
                   └ <softpack_mcp.services.spack_service.SpackService object at 0x7fa478cc3a70>

> File "/home/ubuntu/work/softpack-mcp/softpack_mcp/services/spack_service.py", line 48, in _run_command
    process = await asyncio.create_subprocess_exec(
                    │       └ <function create_subprocess_exec at 0x7fa47c669260>
                    └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>

  File "/usr/local/lib/python3.12/asyncio/subprocess.py", line 224, in create_subprocess_exec
    transport, protocol = await loop.subprocess_exec(
                                │    └ <cyfunction Loop.subprocess_exec at 0x7fa4792f1560>
                                └ <uvloop.Loop running=True closed=False debug=False>
  File "uvloop/loop.pyx", line 2841, in subprocess_exec
    return await self.__subprocess_run(protocol_factory, args, shell=False,
  File "uvloop/loop.pyx", line 2799, in __subprocess_run
    proc = UVProcessTransport.new(self, protocol,
           └ <class 'uvloop.loop.UVProcessTransport'>
  File "uvloop/handles/process.pyx", line 611, in uvloop.loop.UVProcessTransport.new
    handle._init(loop, args, env, cwd, start_new_session,
  File "uvloop/handles/process.pyx", line 112, in uvloop.loop.UVProcess._init
    raise convert_error(err)

FileNotFoundError: [Errno 2] No such file or directory
2025-06-26 13:56:16 | ERROR    | softpack_mcp.services.spack_service:search_packages:120 | Package search failed
2025-06-26 13:56:16 | ERROR    | softpack_mcp.tools.spack:list_packages:47 | Failed to list packages
2025-06-26 13:56:16 | WARNING  | softpack_mcp.utils.exceptions:http_exception_handler:69 | HTTP exception
2025-06-26 13:58:32 | INFO     | softpack_mcp.main:lifespan:26 | Shutting down Softpack MCP server
2025-06-26 13:58:34 | INFO     | softpack_mcp.main:lifespan:22 | Starting Softpack MCP server
2025-06-26 13:58:39 | INFO     | softpack_mcp.services.spack_service:__init__:26 | Initialized SpackService
2025-06-26 13:58:39 | INFO     | softpack_mcp.services.spack_service:search_packages:111 | Searching packages
2025-06-26 13:58:39 | DEBUG    | softpack_mcp.services.spack_service:_run_command:45 | Running command
2025-06-26 13:58:39 | ERROR    | softpack_mcp.services.spack_service:_run_command:88 | Command execution failed
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7f5946f81580>
    │       └ <function run at 0x7f5943ada340>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7f5943ada5c0>
    └ <uvicorn.server.Server object at 0x7f5943aceea0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7f5943ada660>
           │       │   └ <uvicorn.server.Server object at 0x7f5943aceea0>
           │       └ <function run at 0x7f5947ccd580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7f5943b34e40>
           │      └ <function Runner.run at 0x7f5946ef0cc0>
           └ <asyncio.runners.Runner object at 0x7f5943b03770>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7f5943b23c60>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f5943b03770>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f59496eeb40>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435646...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7f5946f81580>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f59496eeb40>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435646...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435646...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f5943531490>
          └ <fastapi.applications.FastAPI object at 0x7f5946f81580>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f59435553a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7f59435313d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f5943531490>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f59435553a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f5943f7b050>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7f59435313d0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f59435553a0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7f59435646e0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f5949728320>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f5943f7b050>
          └ <function wrap_app_handling_exceptions at 0x7f594477a2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f59435554e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7f5949728320>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f59435554e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f5949728320>>
          └ <fastapi.routing.APIRouter object at 0x7f5949728320>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f59435554e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7f594477b7e0>
          └ APIRoute(path='/api/v1/spack/packages', name='list_packages', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f59435554e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7f5943f8e660>
          └ APIRoute(path='/api/v1/spack/packages', name='list_packages', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f59435554e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7f5943564830>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f5943555580>
          └ <function wrap_app_handling_exceptions at 0x7f594477a2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f59435556c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f59435...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f5943555580>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x7f5943564830>
                     └ <function get_request_handler.<locals>.app at 0x7f5943f8d800>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f5944779bc0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'spack': <softpack_mcp.services.spack_service.SpackService object at 0x7f5943acffb0>, 'query': '', 'limit': 10}
                 │         └ <function list_packages at 0x7f5943f3f740>
                 └ Dependant(path_params=[], query_params=[ModelField(field_info=Query(), name='query', mode='validation'), ModelField(field_inf...

  File "/home/ubuntu/work/softpack-mcp/softpack_mcp/tools/spack.py", line 44, in list_packages
    packages = await spack.search_packages(query=query, limit=limit)
                     │     │                     │            └ 10
                     │     │                     └ ''
                     │     └ <function SpackService.search_packages at 0x7f5943f8cd60>
                     └ <softpack_mcp.services.spack_service.SpackService object at 0x7f5943acffb0>

  File "/home/ubuntu/work/softpack-mcp/softpack_mcp/services/spack_service.py", line 117, in search_packages
    result = await self._run_command(cmd)
                   │    │            └ ['/opt/spack/bin/spack', 'list']
                   │    └ <function SpackService._run_command at 0x7f5943f8c860>
                   └ <softpack_mcp.services.spack_service.SpackService object at 0x7f5943acffb0>

> File "/home/ubuntu/work/softpack-mcp/softpack_mcp/services/spack_service.py", line 48, in _run_command
    process = await asyncio.create_subprocess_exec(
                    │       └ <function create_subprocess_exec at 0x7f5946f09260>
                    └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>

  File "/usr/local/lib/python3.12/asyncio/subprocess.py", line 224, in create_subprocess_exec
    transport, protocol = await loop.subprocess_exec(
                                │    └ <cyfunction Loop.subprocess_exec at 0x7f5943b91560>
                                └ <uvloop.Loop running=True closed=False debug=False>
  File "uvloop/loop.pyx", line 2841, in subprocess_exec
    return await self.__subprocess_run(protocol_factory, args, shell=False,
  File "uvloop/loop.pyx", line 2799, in __subprocess_run
    proc = UVProcessTransport.new(self, protocol,
           └ <class 'uvloop.loop.UVProcessTransport'>
  File "uvloop/handles/process.pyx", line 611, in uvloop.loop.UVProcessTransport.new
    handle._init(loop, args, env, cwd, start_new_session,
  File "uvloop/handles/process.pyx", line 112, in uvloop.loop.UVProcess._init
    raise convert_error(err)

FileNotFoundError: [Errno 2] No such file or directory
2025-06-26 13:58:39 | ERROR    | softpack_mcp.services.spack_service:search_packages:120 | Package search failed
2025-06-26 14:04:36 | INFO     | softpack_mcp.main:lifespan:22 | Starting Softpack MCP server
2025-06-26 14:04:36 | INFO     | softpack_mcp.main:lifespan:26 | Shutting down Softpack MCP server
2025-06-26 14:04:48 | INFO     | softpack_mcp.main:lifespan:26 | Shutting down Softpack MCP server
2025-06-26 14:04:59 | INFO     | softpack_mcp.main:lifespan:22 | Starting Softpack MCP server
2025-06-26 14:05:08 | INFO     | softpack_mcp.services.spack_service:__init__:30 | Initialized SpackService
2025-06-26 14:05:08 | INFO     | softpack_mcp.services.spack_service:search_packages:115 | Searching packages
2025-06-26 14:05:13 | INFO     | softpack_mcp.services.spack_service:search_packages:143 | Found packages
2025-06-26 14:05:15 | INFO     | softpack_mcp.services.spack_service:search_packages:115 | Searching packages
2025-06-26 14:05:19 | INFO     | softpack_mcp.services.spack_service:search_packages:143 | Found packages
2025-06-26 14:06:31 | INFO     | softpack_mcp.services.spack_service:install_package:173 | Installing package
2025-06-26 14:10:58 | SUCCESS  | softpack_mcp.services.spack_service:install_package:180 | Package installed successfully
2025-06-26 14:13:46 | INFO     | softpack_mcp.services.spack_service:install_package:173 | Installing package
2025-06-26 14:14:30 | ERROR    | softpack_mcp.services.spack_service:_run_command:72 | Command failed
2025-06-26 14:14:30 | ERROR    | softpack_mcp.services.spack_service:install_package:183 | Package installation failed
2025-06-26 14:15:56 | INFO     | softpack_mcp.services.spack_service:install_package:173 | Installing package
2025-06-26 14:16:40 | SUCCESS  | softpack_mcp.services.spack_service:install_package:180 | Package installed successfully
2025-06-26 14:21:54 | INFO     | softpack_mcp.services.spack_service:install_package:173 | Installing package
2025-06-26 14:22:36 | SUCCESS  | softpack_mcp.services.spack_service:install_package:180 | Package installed successfully
2025-06-26 14:45:19 | INFO     | softpack_mcp.main:lifespan:26 | Shutting down Softpack MCP server
2025-06-26 14:45:31 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 14:47:40 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 14:47:40 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 14:47:40 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 14:47:40 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 14:50:45 | ERROR    | softpack_mcp.utils.exceptions:general_exception_handler:84 | Unhandled exception
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7fcbff9068d0>
    │       └ <function run at 0x7fcbf9476520>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7fcbf94767a0>
    └ <uvicorn.server.Server object at 0x7fcbf946ac30>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fcbf9476840>
           │       │   └ <uvicorn.server.Server object at 0x7fcbf946ac30>
           │       └ <function run at 0x7fcbfdeb1580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7fcbf8adece0>
           │      └ <function Runner.run at 0x7fcbfd0d0cc0>
           └ <asyncio.runners.Runner object at 0x7fcbf93e3e00>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7fcbf8b69d80>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7fcbf93e3e00>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fcbf8b21040>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88a05...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7fcbff9068d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fcbf8b21040>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88a05...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88a05...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fcbf8819a90>
          └ <fastapi.applications.FastAPI object at 0x7fcbff9068d0>
> File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fcbf88a5120>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fcbf8819a60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fcbf8819a90>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fcbf88a5120>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fcbf8f32cf0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fcbf8819a60>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fcbf88a5120>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7fcbf88a0860>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fcbf8eef0b0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fcbf8f32cf0>
          └ <function wrap_app_handling_exceptions at 0x7fcbfa95e2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a5440>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7fcbf8eef0b0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a5440>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fcbf8eef0b0>>
          └ <fastapi.routing.APIRouter object at 0x7fcbf8eef0b0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a5440>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7fcbfa95f7e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a5440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7fcbf8b34180>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a5440>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7fcbf88a0770>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fcbf88a5580>
          └ <function wrap_app_handling_exceptions at 0x7fcbfa95e2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a4360>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fcbf88a5580>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 74, in app
    await response(scope, receive, send)
          │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a4360>
          │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88...
          │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <starlette.responses.JSONResponse object at 0x7fcbf8f6a1b0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/responses.py", line 150, in __call__
    await send(
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a4360>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fcbf88a5440>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fcbf88a5120>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in _send
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fcbf88a05...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 517, in send
    raise RuntimeError(msg % message_type)
                       │     └ 'http.response.start'
                       └ "Expected ASGI message 'http.response.body', but got '%s'."

RuntimeError: Expected ASGI message 'http.response.body', but got 'http.response.start'.
2025-06-26 14:50:45 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 14:50:48 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 14:50:50 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 15:00:34 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 15:00:43 | ERROR    | softpack_mcp.utils.exceptions:general_exception_handler:84 | Unhandled exception
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7fee244974d0>
    │       └ <function run at 0x7fee2428a520>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7fee2428a7a0>
    └ <uvicorn.server.Server object at 0x7fee2391aea0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fee2428a840>
           │       │   └ <uvicorn.server.Server object at 0x7fee2391aea0>
           │       └ <function run at 0x7fee28cc9580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7fee238eece0>
           │      └ <function Runner.run at 0x7fee27ee8cc0>
           └ <asyncio.runners.Runner object at 0x7fee24d88fe0>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7fee2397dbe0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7fee24d88fe0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fee23d0b5c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee23664a...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7fee244974d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fee23d0b5c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee23664a...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee23664a...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fee2362dbb0>
          └ <fastapi.applications.FastAPI object at 0x7fee244974d0>
> File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fee236a9760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fee2362db20>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fee2362dbb0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fee236a9760>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fee2362db80>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fee2362db20>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fee236a9760>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7fee23664d40>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fee243704a0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fee2362db80>
          └ <function wrap_app_handling_exceptions at 0x7fee257762a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee236598a0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7fee243704a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee236598a0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fee243704a0>>
          └ <fastapi.routing.APIRouter object at 0x7fee243704a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee236598a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7fee257777e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee236598a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7fee239580e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee236598a0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7fee23665610>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fee23659ee0>
          └ <function wrap_app_handling_exceptions at 0x7fee257762a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee23659d00>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fee23659ee0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 74, in app
    await response(scope, receive, send)
          │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee23659d00>
          │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee236...
          │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <starlette.responses.JSONResponse object at 0x7fee23666300>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/responses.py", line 150, in __call__
    await send(
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee23659d00>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fee236598a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fee236a9760>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in _send
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fee23664a...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 517, in send
    raise RuntimeError(msg % message_type)
                       │     └ 'http.response.start'
                       └ "Expected ASGI message 'http.response.body', but got '%s'."

RuntimeError: Expected ASGI message 'http.response.body', but got 'http.response.start'.
2025-06-26 15:00:43 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 15:00:45 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 15:00:53 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 15:02:24 | ERROR    | softpack_mcp.utils.exceptions:general_exception_handler:84 | Unhandled exception
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7faaa8656db0>
    │       └ <function run at 0x7faaa0e76520>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7faaa0e767a0>
    └ <uvicorn.server.Server object at 0x7faaa0506f90>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7faaa0e76840>
           │       │   └ <uvicorn.server.Server object at 0x7faaa0506f90>
           │       └ <function run at 0x7faaa58b9580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7faaa04deea0>
           │      └ <function Runner.run at 0x7faaa4ae0cc0>
           └ <asyncio.runners.Runner object at 0x7faaa08f6c90>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7faaa0569b10>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7faaa08f6c90>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7faaa08f5880>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02546...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7faaa8656db0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7faaa08f5880>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02546...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02546...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7faaa01c4830>
          └ <fastapi.applications.FastAPI object at 0x7faaa8656db0>
> File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7faaa0249580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7faaa021da90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7faaa01c4830>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7faaa0249580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7faaa021dac0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7faaa021da90>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7faaa0249580>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7faaa0254770>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7faaa0de0f20>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7faaa021dac0>
          └ <function wrap_app_handling_exceptions at 0x7faaa23662a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02496c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7faaa0de0f20>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02496c0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7faaa0de0f20>>
          └ <fastapi.routing.APIRouter object at 0x7faaa0de0f20>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02496c0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7faaa23677e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02496c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7faaa05400e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02496c0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7faaa02548f0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7faaa0249760>
          └ <function wrap_app_handling_exceptions at 0x7faaa23662a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02498a0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7faaa0249760>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 74, in app
    await response(scope, receive, send)
          │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02498a0>
          │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02...
          │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <starlette.responses.JSONResponse object at 0x7faaa0e1bc50>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/responses.py", line 150, in __call__
    await send(
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02498a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7faaa02496c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7faaa0249580>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in _send
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7faaa02546...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 517, in send
    raise RuntimeError(msg % message_type)
                       │     └ 'http.response.start'
                       └ "Expected ASGI message 'http.response.body', but got '%s'."

RuntimeError: Expected ASGI message 'http.response.body', but got 'http.response.start'.
2025-06-26 15:02:25 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 15:02:27 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 15:02:30 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 15:03:03 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type CallToolRequest
2025-06-26 15:03:03 | INFO     | softpack_mcp.services.spack_service:__init__:30 | Initialized SpackService
2025-06-26 15:03:03 | INFO     | softpack_mcp.services.spack_service:search_packages:115 | Searching packages
2025-06-26 15:03:08 | INFO     | softpack_mcp.services.spack_service:search_packages:143 | Found packages
2025-06-26 15:43:39 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 15:43:39 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 15:43:41 | ERROR    | softpack_mcp.utils.exceptions:general_exception_handler:84 | Unhandled exception
Traceback (most recent call last):

  File "/home/ubuntu/work/softpack-mcp/main.py", line 11, in <module>
    uvicorn.run(app, host="0.0.0.0", port=8000)
    │       │   └ <fastapi.applications.FastAPI object at 0x7fc3235dedb0>
    │       └ <function run at 0x7fc31d172520>
    └ <module 'uvicorn' from '/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/__init__.py'>

  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x7fc31d1727a0>
    └ <uvicorn.server.Server object at 0x7fc31cc31f40>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7fc31d172840>
           │       │   └ <uvicorn.server.Server object at 0x7fc31cc31f40>
           │       └ <function run at 0x7fc321bb1580>
           └ <module 'asyncio' from '/usr/local/lib/python3.12/asyncio/__init__.py'>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7fc31c7dece0>
           │      └ <function Runner.run at 0x7fc320dd0cc0>
           └ <asyncio.runners.Runner object at 0x7fc31cb8acc0>
  File "/usr/local/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages...
           │    │     └ <cyfunction Loop.run_until_complete at 0x7fc31c865be0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7fc31cb8acc0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fc31c821130>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c54c6...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x7fc3235dedb0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fc31c821130>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c54c6...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c54c6...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fc31c4bc830>
          └ <fastapi.applications.FastAPI object at 0x7fc3235dedb0>
> File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fc31c53d580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7fc31c515a90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fc31c4bc830>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fc31c53d580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fc31c515ac0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7fc31c515a90>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fc31c53d580>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x7fc31c516d80>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fc31cc696d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fc31c515ac0>
          └ <function wrap_app_handling_exceptions at 0x7fc31e65e2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d6c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x7fc31cc696d0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d6c0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fc31cc696d0>>
          └ <fastapi.routing.APIRouter object at 0x7fc31cc696d0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d6c0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x7fc31e65f7e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d6c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x7fc31c83c0e0>
          └ APIRoute(path='/mcp', name='handle_mcp_connection', methods=['GET'])
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d6c0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x7fc31c54c7d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fc31c53d760>
          └ <function wrap_app_handling_exceptions at 0x7fc31e65e2a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d8a0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fc31c53d760>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/routing.py", line 74, in app
    await response(scope, receive, send)
          │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d8a0>
          │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c5...
          │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <starlette.responses.JSONResponse object at 0x7fc31c821490>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/responses.py", line 150, in __call__
    await send(
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d8a0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fc31c53d6c0>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 39, in sender
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fc31c53d580>
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in _send
    await send(message)
          │    └ {'type': 'http.response.start', 'status': 200, 'headers': [(b'content-length', b'4'), (b'content-type', b'application/json')]}
          └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fc31c54c6...
  File "/home/ubuntu/work/softpack-mcp/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 517, in send
    raise RuntimeError(msg % message_type)
                       │     └ 'http.response.start'
                       └ "Expected ASGI message 'http.response.body', but got '%s'."

RuntimeError: Expected ASGI message 'http.response.body', but got 'http.response.start'.
2025-06-26 15:43:41 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 15:44:04 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 15:44:57 | INFO     | softpack_mcp.services.spack_service:__init__:30 | Initialized SpackService
2025-06-26 15:44:57 | INFO     | softpack_mcp.services.spack_service:search_packages:115 | Searching packages
2025-06-26 15:45:01 | INFO     | softpack_mcp.services.spack_service:search_packages:144 | Found packages
2025-06-26 15:47:24 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 15:47:44 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type CallToolRequest
2025-06-26 15:47:44 | INFO     | softpack_mcp.services.spack_service:get_package_info:255 | Getting package info
2025-06-26 15:54:30 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type CallToolRequest
2025-06-26 15:54:30 | INFO     | softpack_mcp.services.spack_service:get_package_info:255 | Getting package info
2025-06-26 15:56:00 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type CallToolRequest
2025-06-26 15:56:00 | INFO     | softpack_mcp.services.spack_service:get_package_info:255 | Getting package info
2025-06-26 15:56:17 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type CallToolRequest
2025-06-26 15:56:17 | INFO     | softpack_mcp.services.spack_service:get_package_info:255 | Getting package info
2025-06-26 15:56:22 | ERROR    | softpack_mcp.services.spack_service:_run_command:72 | Command failed
2025-06-26 15:56:22 | ERROR    | softpack_mcp.services.spack_service:get_package_info:261 | Failed to get package info
2025-06-26 15:56:46 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 15:56:53 | WARNING  | fastapi_mcp.transport.sse:handle_fastapi_post_message:54 | Could not find session for ID: 20b798aa-935b-4aec-876c-2816d0c167a7
2025-06-26 15:56:53 | WARNING  | softpack_mcp.utils.exceptions:http_exception_handler:69 | HTTP exception
2025-06-26 15:58:02 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 15:58:13 | INFO     | softpack_mcp.main:lifespan:23 | Starting Softpack MCP server
2025-06-26 15:58:33 | INFO     | softpack_mcp.services.spack_service:__init__:30 | Initialized SpackService
2025-06-26 15:58:33 | INFO     | softpack_mcp.services.spack_service:get_package_info:259 | Getting package info
2025-06-26 15:58:46 | INFO     | softpack_mcp.services.spack_service:get_package_info:259 | Getting package info
2025-06-26 15:59:32 | INFO     | softpack_mcp.main:lifespan:27 | Shutting down Softpack MCP server
2025-06-26 15:59:33 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type ListToolsRequest
2025-06-26 15:59:59 | INFO     | mcp.server.lowlevel.server:_handle_request:523 | Processing request of type CallToolRequest
2025-06-26 15:59:59 | INFO     | softpack_mcp.services.spack_service:get_package_info:259 | Getting package info
